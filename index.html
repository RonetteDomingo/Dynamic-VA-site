<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>S‑Class VA – Dynamic Site (Google Sheets CMS)</title>
<meta name="description" content="Dynamic VA portfolio with Insights blog and Portfolio items powered by Google Sheets (no-code updates).">
<style>
:root{
  --white:#ffffff; --gold:#C1914D; --bronze:#A16A27; --deep-brown:#78420B; --dark:#120B08;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;background:var(--dark);color:var(--white);}
a{color:var(--gold);text-decoration:none}
header{position:sticky;top:0;background:rgba(18,11,8,.8);backdrop-filter:saturate(180%) blur(8px);border-bottom:1px solid #2a1a13;z-index:20}
.wrap{max-width:1100px;margin:0 auto;padding:18px}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--gold),var(--bronze));}
.brand h1{font-size:1.05rem;margin:0;color:var(--gold);letter-spacing:.5px}
nav{display:flex;gap:16px;align-items:center}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px}
section{padding:48px 18px;border-top:1px solid #2a1a13}
h2{margin:0 0 14px;font-size:1.6rem;color:var(--gold)}
p.lead{color:#d5c9bc;margin:0 0 18px}
.card{background:#1c120f;border:1px solid #2a1a13;border-radius:16px;overflow:hidden;box-shadow:0 4px 18px rgba(0,0,0,.25)}
.card .thumb{width:100%;aspect-ratio:16/9;object-fit:cover;background:#2a1a13}
.card .pad{padding:14px}
.badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:.75rem;border:1px solid var(--bronze);color:var(--gold);}
.muted{color:#cab39a}
.btn{display:inline-flex;align-items:center;gap:8px;background:var(--gold);color:var(--dark);font-weight:700;border:none;border-radius:12px;padding:10px 14px;cursor:pointer}
.btn:disabled{opacity:.6;cursor:not-allowed}
.toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin:10px 0 18px}
input[type="search"],select{background:#1c120f;border:1px solid #2a1a13;color:#f6efe7;border-radius:10px;padding:10px}
footer{padding:40px 18px;border-top:1px solid #2a1a13;color:#bda78f}
.notice{background:#24160f;border:1px dashed var(--deep-brown);padding:12px 14px;border-radius:12px;color:#e9dccb}
.flex{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
iframe.thumb, video.thumb{width:100%;aspect-ratio:16/9;border:none;border-radius:8px;background:#2a1a13}
</style>
</head>
<body>
<header>
  <div class="wrap flex" style="justify-content:space-between">
    <div class="brand"><div class="logo"></div><h1>S‑Class VA – Dynamic</h1></div>
    <nav>
      <a href="#insights">Insights</a>
      <a href="#portfolio">Portfolio</a>
      <a href="#how-to">How to Update</a>
    </nav>
  </div>
</header>

<main>
<section class="wrap" id="hero" style="padding-top:28px">
<div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(280px,1fr))">
  <div>
    <h2>From Seafaring to S‑Class Virtual Assistance</h2>
    <p class="lead">This demo is a <strong>clone-ready dynamic version</strong> of your site. Update <em>Insights</em> articles and <em>Portfolio</em> items from Google Sheets — no code edits needed.</p>
    <div class="notice" id="statusBox">Connecting to Google Sheets…</div>
    <div class="toolbar">
      <button class="btn" id="refreshBtn">↻ Refresh Content</button>
    </div>
  </div>
  <div class="card"><img class="thumb" src="https://images.unsplash.com/photo-1467232004584-a241de8bcf5d?q=80&w=1200&auto=format&fit=crop" alt="Workspace"/><div class="pad"><span class="badge">Live Preview</span><p class="muted">Brand colors applied • Responsive • Cards auto‑rendered from Sheets.</p></div></div>
</div>
</section>

<section id="insights">
<div class="wrap">
<h2>Insights</h2>
<p class="lead">Articles loaded from your Google Sheet <em>(sheet tab: Insights)</em>.</p>
<div class="toolbar">
<input type="search" id="insightsSearch" placeholder="Search articles…" />
<select id="insightsTag"><option value="">All tags</option></select>
</div>
<div class="grid" id="insightsGrid"></div>
</div>
</section>

<section id="portfolio">
<div class="wrap">
<h2>Portfolio</h2>
<p class="lead">Projects loaded from your Google Sheet <em>(sheet tab: Portfolio)</em>.</p>
<div class="toolbar">
<input type="search" id="portfolioSearch" placeholder="Search projects…" />
<select id="portfolioTag"><option value="">All tags</option></select>
</div>
<div class="grid" id="portfolioGrid"></div>
</div>
</section>

<section id="how-to">
<div class="wrap">
<h2>How to Update (No Code)</h2>
<ol class="lead">
<li>Create a Google Spreadsheet with two tabs named <strong>Insights</strong> and <strong>Portfolio</strong>.</li>
<li>Set columns exactly as below (row 1 = headers):</li>
</ol>
<div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(300px,1fr))">
  <div class="card"><div class="pad">
    <h3 style="margin:0 0 8px;color:var(--bronze)">Insights – Columns</h3>
    <pre style="white-space:pre-wrap;color:#e6d7c2">Title | Excerpt | Tag | ImageURL | ReadMoreURL | Date</pre>
  </div></div>
  <div class="card"><div class="pad">
    <h3 style="margin:0 0 8px;color:var(--bronze)">Portfolio – Columns</h3>
    <pre style="white-space:pre-wrap;color:#e6d7c2">Title | Description | Tag | ImageURL | ProjectURL | Date</pre>
  </div></div>
</div>
<p class="lead">Then go to <strong>File → Share → Publish to web</strong> (Entire doc). Copy the Spreadsheet ID and paste it in the <code>SPREADSHEET_ID</code> variable.</p>
<div class="notice">Tip: Keep the sheet tidy. Each new row = 1 new card on the website.</div>
</div>
</section>
</main>

<footer>
<div class="wrap">
© <span id="year"></span> S‑Class VA • Dynamic demo. Built for cloning & rapid deployment.
</div>
</footer>

<script>
// === EDIT THIS: Replace with your own Google Spreadsheet ID ===
// To find your Spreadsheet ID, open your Google Sheet and look at the URL:
// https://docs.google.com/spreadsheets/d/THIS_IS_YOUR_SPREADSHEET_ID/edit#gid=0
const SPREADSHEET_ID = "1xZV6iDwOR87zOZr8qwCMiMejuzsj-VeRmXZD1TRQxEA";

// These are the tab (sheet) names inside your Google Spreadsheet.
// Make sure your sheet tabs are exactly named like this or edit these variables.
const SHEET_INSIGHTS = "Insights";
const SHEET_PORTFOLIO = "Portfolio";

/* The rest of the script fetches data from your spreadsheet based on
   SPREADSHEET_ID and these sheet names, and renders your website content dynamically. */

const yearEl = document.getElementById('year');
yearEl.textContent = new Date().getFullYear();
const statusBox = document.getElementById('statusBox');
const refreshBtn = document.getElementById('refreshBtn');

function setStatus(msg){ if(statusBox) statusBox.textContent = msg; }
function gvizUrl(sheetName){ return `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`; }

async function fetchSheet(sheetName){
  const res = await fetch(gvizUrl(sheetName));
  const text = await res.text();
  const match = text.match(/google\.visualization\.Query\.setResponse\((.*)\)/);
  if(!match) throw new Error("Failed to parse Google Sheets JSON.");
  const json = JSON.parse(match[1]);
  const rows = json.table.rows.map(r => (r.c||[]).map(c => c? c.v : ""));
  const headers = json.table.cols.map(c => c.label || "");
  return {headers, rows};
}

function toObjects({headers, rows}){ return rows.map(r=>Object.fromEntries(headers.map((h,i)=>[h.trim(), r[i] ?? ""]))); }

function normalizeMediaURL(url){
  if(!url) return "";
  const yt = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]+)/);
  if(yt) return {type:'youtube', src:`https://www.youtube.com/embed/${yt[1]}`};
  const drive = url.match(/\/d\/([a-zA-Z0-9_-]+)/);
  if(drive) return {type:'drive', src:`https://drive.google.com/file/d/${drive[1]}/preview`};
  const ext = url.split('.').pop().toLowerCase();
  if(['mp4','mov','avi'].includes(ext)) return {type:'video', src:url};
  if(['jpg','jpeg','png','webp','gif'].includes(ext)) return {type:'image', src:url};
  if(['pdf','doc','docx'].includes(ext)) return {type:'iframe', src:url};
  return {type:'link', src:url};
}

function createCard({img, url, title, desc, tag}){
  const media = normalizeMediaURL(img || url);
  let mediaContent = "";
  if(media.type==='image') mediaContent=`<img class="thumb" loading="lazy" src="${media.src}" alt="${title||''}">`;
  else if(media.type==='video') mediaContent=`<video class="thumb" controls><source src="${media.src}" type="video/mp4">Your browser does not support the video tag.</video>`;
  else if(media.type==='youtube' || media.type==='iframe' || media.type==='drive') mediaContent=`<iframe class="thumb" src="${media.src}" frameborder="0" allowfullscreen></iframe>`;
  
  return `<article class="card">
    ${mediaContent}
    <div class="pad">
      ${tag?`<span class="badge">${tag}</span>`:""}
      <h3 style="margin:10px 0 6px">${title||''}</h3>
      <p class="muted">${desc||''}</p>
      <div class="flex" style="justify-content:space-between;margin-top:10px">
        ${media.type==='link'?`<a class="btn" href="${media.src}" target="_blank" rel="noopener">Open</a>`:"<span></span>"}
      </div>
    </div>
  </article>`;
}

function populateSelect(sel, items){
  const unique = Array.from(new Set(items.filter(Boolean))).sort();
  sel.innerHTML = `<option value="">All tags</option>` + unique.map(t=>`<option value="${t}">${t}</option>`).join('');
}

function filterAndRender(data,{q,tag},grid){
  const query = (q||"").toLowerCase();
  const filtered = data.filter(o=>(!tag||o.tag===tag)&&(!query||o.title.toLowerCase().includes(query)||o.desc.toLowerCase().includes(query)));
  grid.innerHTML = filtered.map(createCard).join('') || `<div class="notice">No items found.</div>`;
}

let INSIGHTS_DATA=[], PORTFOLIO_DATA=[];

async function loadAll(){
  try{
    setStatus('Loading content…');
    const [insRaw, portRaw] = await Promise.all([fetchSheet(SHEET_INSIGHTS), fetchSheet(SHEET_PORTFOLIO)]);
    INSIGHTS_DATA = toObjects(insRaw).map(o=>({title:o.Title, desc:o.Excerpt, tag:o.Tag, img:o.ImageURL, url:o.ReadMoreURL}));
    PORTFOLIO_DATA = toObjects(portRaw).map(o=>({title:o.Title, desc:o.Description, tag:o.Tag, img:o.ImageURL, url:o.ProjectURL}));
    populateSelect(document.getElementById('insightsTag'), INSIGHTS_DATA.map(x=>x.tag));
    populateSelect(document.getElementById('portfolioTag'), PORTFOLIO_DATA.map(x=>x.tag));
    filterAndRender(INSIGHTS_DATA,{q:'',tag:''},document.getElementById('insightsGrid'));
    filterAndRender(PORTFOLIO_DATA,{q:'',tag:''},document.getElementById('portfolioGrid'));
    setStatus('Connected ✔ — content is live from Google Sheets.');
  } catch(e){ console.error(e); setStatus('Failed to load. Check spreadsheet ID and publish settings.'); }
}

refreshBtn.addEventListener('click', loadAll);
document.getElementById('insightsSearch').addEventListener('input', e=>filterAndRender(INSIGHTS_DATA,{q:e.target.value,tag:document.getElementById('insightsTag').value},document.getElementById('insightsGrid')));
document.getElementById('insightsTag').addEventListener('change', e=>filterAndRender(INSIGHTS_DATA,{q:document.getElementById('insightsSearch').value,tag:e.target.value},document.getElementById('insightsGrid')));
document.getElementById('portfolioSearch').addEventListener('input', e=>filterAndRender(PORTFOLIO_DATA,{q:e.target.value,tag:document.getElementById('portfolioTag').value},document.getElementById('portfolioGrid')));
document.getElementById('portfolioTag').addEventListener('change', e=>filterAndRender(PORTFOLIO_DATA,{q:document.getElementById('portfolioSearch').value,tag:e.target.value},document.getElementById('portfolioGrid')));

loadAll();
</script>
</body>
</html>
